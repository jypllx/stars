{% extends "mobile/_base_mobile.html" %}

{% block content %}
<div class="row">
    <form method="post" action="{{url_for('mob_search')}}">
        <div class="col-xs-12">
            <div class="row">
                <h3><p class="text-center">Rechercher</p></h3>
            </div>
            <div class="row">
                <input name="search" placeholder="Recherche" type="text" class="form-control">
            </div>
            <br/>
            <div class="row time-filter">
                {% for category in time_categories %}
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-time" value="{{category.id}}" id="time{{category.id}}"><i class="fa {{category.icon}}"></i>&nbsp;{{category.name}}</a></div>
                {% endfor %}
                <input id="cat_time" type="hidden" name="cat_time" value="">
            </div>
            <br/>
            <div class="row type-filter">
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-type box" value="0" id="type0">News</a></div>
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-type box" value="1" id="type1">Reportage</a></div>
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-type box" value="2" id="type2">Livre</a></div>
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-type box" value="3" id="type3">Conférence</a></div>
                <input id="cat_type" type="hidden" name="cat_type" value="">
            </div>
            {% for tag in tags %}
                <div class="row">
                    <p class="text-center"><b>{{tag.name}}</b></p>
                </div>
                <div class="row">
                {% if tag.playlists %}
                    {% set i=0 %}
                    {% for p in tag.playlists %}
                        {% if i < 4 %}
                            <div class="col-xs-3"><a class="btn btn-default btn-block btn-playlist box" id="{{p.id}}">{{p.name}}</a></div>
                        {% set i=i+1 %}
                    {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
            {% endfor %}

            <input id="playlist" type="hidden" name="playlist_id" value="">
            <div class="row">
                <p class="text-center"><b>Vos chaînes préférées</b></p>
            </div>

            <div class="row">
            {% for channel in channels %}
                <div class="col-xs-3"><a class="btn btn-default btn-block btn-channel box" id="{{channel.id}}">{{channel.name}}</a></div>
            {% endfor %}
            </div>
            <input id="channel" type="hidden" name="channel_id" value="">
        </div>
        <input id="mood" type="hidden" name="mood" value="">
    </form>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
    $(document).ready(function(){
        search = function() {
            $('form').submit()
        }
        $(".btn-time").click(function(){
            $('#cat_time').attr('value', $(this).attr('value'))
            search()
        });
        $(".btn-type").click(function(){
            $('#cat_type').attr('value', $(this).attr('value')) 
            search()
        });
        $(".btn-playlist").click(function(){
            $('#playlist').attr('value', $(this).attr('id'))
            search()
        });
        $(".btn-channel").click(function(){
            $('#channel').attr('value', $(this).attr('id'))
            search()
        });
    });
</script>
{% endblock %}