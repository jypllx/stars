{% extends "mobile/_base_mobile.html" %}

{% block content %}
<div class="row">
    <form method="post" action="{{url_for('mob_search')}}">
        <div class="col-xs-12">
            <div class="row">
                <h3><p class="text-center">Rechercher</p></h3>
            </div>
            <div class="row">
                <input name="search" placeholder="Recherche" type="text" class="form-control">
            </div>
            <br/>
            <div class="row time-filter">
                {% for category in time_categories %}
                <div class="col-xs-3"><a class="btn btn-block btn-default btn-time" value="{{category.id}}" id="time{{category.id}}"><i class="fa {{category.icon}}"></i>&nbsp;{{category.name}}</a></div>
                {% endfor %}
                <input id="cat_time" type="hidden" name="cat_time" value="">
            </div>
            <br/>
            {% for tag in tags %}
                <div class="row">
                    <p class="text-center"><b>{{tag.name}}</b></p>
                </div>
                <div class="row">
                {% if tag.playlists %}
                    {% set i=0 %}
                    {% for p in tag.playlists %}
                        {% if i < 4 %}
                            <div class="col-xs-3"><a class="btn btn-default btn-block btn-playlist box" id="{{p.id}}">{{p.name}}</a></div>
                        {% set i=i+1 %}
                    {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
            {% endfor %}

            <input id="playlist" type="hidden" name="playlist_id" value="">
            
            <div class="row">
                <p class="text-center"><b>Sources</b></p>
            </div>
            {% set i=0 %}
            {% for source in sources %}
            {% if i % 4 == 0 %}
                <div class="row">
            {% endif %}
                <div class="col-xs-3"><a class="btn btn-default btn-block btn-source box" id="{{source}}">{{source}}</a></div>
            {% if i % 4 == 3 or i == sources|length() -1 %}
                </div>
            {% endif %}
            {% set i=i+1 %}
            {% endfor %}
            <input id="source" type="hidden" name="source" value="">
        </div>
        <input id="mood" type="hidden" name="mood" value="">
    </form>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
    $(document).ready(function(){
        search = function() {
            $('form').submit()
        }
        $(".btn-time").click(function(){
            $('#cat_time').attr('value', $(this).attr('value'))
            search()
        });
        $(".btn-type").click(function(){
            $('#cat_type').attr('value', $(this).attr('value')) 
            search()
        });
        $(".btn-playlist").click(function(){
            $('#playlist').attr('value', $(this).attr('id'))
            search()
        });
        $(".btn-source").click(function(){
            $('#source').attr('value', $(this).attr('id'))
            search()
        });
    });
</script>
{% endblock %}