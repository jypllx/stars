{% extends "bo/_base.html" %}

{% block content %}

<h1>Episodes</h1>
<div>
    <form method="post">
        <div class="form-group">
            <label for="search_title">Titre</label>
            <input type="text" class="form-control" name="search_title" placeholder="Rechercher..." value="{{search_title}}">
        </div>
        <div class="form-group">
            <label for="search_desc">Description</label>
            <input type="text" class="form-control" name="search_desc" placeholder="Rechercher..." value="{{search_desc}}">
        </div>
        <div class="form-group">
            <label for="search_iCat">Genre</label>
            <select class="form-control" name="search_iCat">
                <option value="">iTunes Category</option>
                {% for iCat in iTunes_categories %}
                <option value="{{iCat}}" {% if search_iCat == iCat %} selected="selected" {% endif %}>{{iCat}}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="search_mood">Mood</label>
            <select class="form-control" name="search_mood">
                <option value="" >Choose Mood</option>
                {% for mood in moods %}
                <option value="{{mood}}" {% if search_mood == mood %} selected="selected" {% endif %}>{{mood}}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="search_length">Durée</label>
            <select class="form-control" name="search_length">
                <option value="" >Durée</option>
                {% for category in time_categories %}
                <option value="{{category['id']}}" {% if search_length|int() == category['id']|int() %} selected="selected" {% endif %}>{{category.name}}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
    </form>
</div>
<br/>
<div>
    <table class="table table-striped table-hover">
        <tr>
            <th>Titre Tootak</th>
            <th>Mood Tootak</th>
            <th>Description Tootak</th>
            <th>Durée*</th>
            <th>Cat durée*</th>
            <th>Cat iTunes*</th>
            <th>Publié le*</th>
            <th></th>
        </tr>
        {% for item in items %}
        <tr id="{{item.id}}">
            <td>{{item.title}}</td>
            <td>{{item.mood}}</td>
            <td>{{item.description}}</td>
            <td>{{item.duration_}}</td>
            <td>{{item.cat_name}}</td>
            <td>{{item.itunes_category_}}</td>
            <td>{{item.pubdate_}}</td>
            <td><div class="dropdown">
                <button class="btn" data-toggle="dropdown"><i class="fa fa-plus"></i>&nbsp;Add to playlist</span></button>
                <ul class="dropdown-menu">
                {% for playlist in playlists %}
                    <li><a class="add_to_playlist" id="{{playlist.id}}.{{item.id}}" href="#">{{playlist.name}}</a></li>
                {% endfor %}
                </ul>
                </div>
                <a href='{{ url_for('items_edit', id=item.id) }}' class='btn btn-default'><i class='fa fa-pencil'></i></a>
            </td>
        </tr>            
        {% endfor %}
    </table>
</div>
<!-- 



<div>
    <table>
        {% for item in items %}
        <div class="well" id="{{item.id}}">
            <h4>{{item.title_}}</h4>
            <p><i>{{item.itunes_category_}}</i></p>
            <p>Publié:&nbsp;{{item.pubdate_}}</p>
            <div>
                <i class="fa fa-clock-o fa-2x"></i>&nbsp;&nbsp;{{item.cat_name}}
            </div>
            <p>{{item.description_}}</p>
            <audio controls>
                <source src="{{item.audio_url_}}" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>

                
            </div>
            {% endfor %}
        </table>
    </div> -->
    {% endblock %}
    {% block js %}
    <script type="text/javascript">
        $(document).ready(function(){
            $(".add_to_playlist").click(function(){
                var ids = $(this).attr('id').split(".")
                $.post('{{ url_for('add_item_to_playlist') }}',
                {
                    playlist_id:ids[0], item_id:ids[1]
                }
                );
            });
        });
    </script>
    {% endblock %}